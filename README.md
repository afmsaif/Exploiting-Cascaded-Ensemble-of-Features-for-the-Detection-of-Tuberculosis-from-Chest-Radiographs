# Exploiting Cascaded Ensemble of Features for the Detection of Tuberculosis Using Chest Radiographs

This repository contains the code implementation for the paper "Exploiting Cascaded Ensemble of Features for the Detection of Tuberculosis Using Chest Radiographs". The goal of this project is to develop a cascaded ensemble method that combines both hand-engineered and deep learning-based features for the task of Tuberculosis (TB) detection using chest radiographs.

## Table of Contents
- [Introduction](#introduction)
- [Features](#features)
- [Requirements](#requirements)
- [Installation](#installation)
- [Dataset](#dataset)
- [Usage](#usage)
- [Model Architecture](#model-architecture)
- [Results](#results)
- [Contributors](#contributors)
- [Citation](#citation)
- [License](#license)
- [Acknowledgments](#acknowledgments)

## Introduction

Tuberculosis (TB) is a communicable disease and a major cause of death worldwide. Early detection of TB is crucial for effective treatment. This project proposes a method that combines both hand-engineered features and deep learning-based features for TB detection from chest radiographs. The method utilizes rotation-invariant augmentation techniques and achieves high accuracy on benchmark datasets.

## Features

- Combination of hand-engineered and deep learning-based features.
- Rotation-invariant augmentation techniques.
- Evaluated on benchmark datasets.
- High accuracy in TB detection.

## Requirements

- Python 3.6 or higher
- TensorFlow 2.x
- Keras
- NumPy
- OpenCV
- Scikit-learn
- Matplotlib

## Installation

1. Clone the repository:

    ```bash
    git clone https://github.com/afmsaif/Exploiting-Cascaded-Ensemble-of-Features-for-the-Detection-of-Tuberculosis-Using-Chest-Radiographs.git
    cd Exploiting-Cascaded-Ensemble-of-Features-for-the-Detection-of-Tuberculosis-Using-Chest-Radiographs
    ```

2. Install the required packages:

    ```bash
    pip install -r requirements.txt
    ```

## Dataset

The model is evaluated on two benchmark datasets:
- Shenzhen dataset.
- Montgomery County dataset.


## Usage

1. **Preprocessing**:
    - Resize images to uniform sizes (224x224).
    - Apply min-max normalization.
    - Use rotation-invariant augmentation techniques to augment the training samples.

    ```bash
    python preprocess.py
    ```

2. **Feature Extraction**:
    - Extract hand-engineered features using various descriptors like Histogram of Oriented Gradients (HOG), Binary Pattern of Phase Congruency (BPPC), Improved Weber Binary Code (IWBC), etc.
    - Extract deep learning-based features using fine-tuned transfer learning models.

3. **Feature Combination**:
    - Combine the extracted features using a logistic regression classifier and a Receptive-Field-Aware neural network.

4. **Training**:
    - Train the final classifier using the combined features.

    ```bash
    python train.py
    ```

5. **Evaluation**:
    - Evaluate the model on benchmark datasets and report accuracy, precision, recall, and F1-score.

    ```bash
    python evaluate.py
    ```

## Model Architecture

The architecture consists of:
1. **Hand-Engineered Feature Extractors**: Extract features using descriptors like HOG, BPPC, and IWBC.
2. **Deep Learning-Based Feature Extractors**: Extract features using pre-trained deep learning models fine-tuned for the task.
3. **Feature Combination Module**: Combines hand-engineered and deep learning-based features.
4. **Classifier**: Logistic regression and Receptive-Field-Aware neural network for final classification.

## Results

The proposed method achieves outstanding performance on two benchmark datasets:
- 99.7% accuracy on the Shenzhen dataset.
- 98.4% accuracy on the Montgomery County dataset.

## Contributors

- A. F. M. Saif, Bangladesh University of Engineering and Technology
- Tamjid Imtiaz, Bangladesh University of Engineering and Technology
- Celia Shahnaz, Bangladesh University of Engineering and Technology
- Wei-Ping Zhu, Concordia University
- M. Omair Ahmad, Concordia University

## Citation

If you find this repository useful in your research, please cite our paper:

```bibtex
@article{saif2021exploiting,
  title={Exploiting Cascaded Ensemble of Features for the Detection of Tuberculosis Using Chest Radiographs},
  author={Saif, AFM and Imtiaz, Tamjid and Shahnaz, Celia and Zhu, Wei-Ping and Ahmad, M Omair},
  journal={IEEE Access},
  volume={9},
  pages={112388--112391},
  year={2021},
  publisher={IEEE}
}
```

